---
import { getCollection } from 'astro:content';
import Base from '../layouts/Base.astro';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort(
  (a, b) => b.data.pubDate.getTime() - a.data.pubDate.getTime()
);

const title = 'Neural Niki';
const description = 'A premium publication exploring AI, technology, investing, and startup economics.';

const featuredPost = sortedPosts[0];
const recentPosts = sortedPosts.slice(1);
---

<Base {title} {description}>
  <!-- Hero Section -->
  <section class="py-hero" style="background: var(--bg-secondary);">
    <div class="container">
      <div style="max-width: 720px; margin: 0 auto; text-align: center;">
        <h1 style="margin: 0 0 1.5rem 0; font-size: clamp(2.5rem, 6vw, 4rem); letter-spacing: -0.03em;">
          Essays on AI, investing & technology
        </h1>
        <p style="margin: 0; font-size: 1.25rem; color: var(--text-tertiary); line-height: 1.7;">
          Thoughtful analysis without the hype. Deep dives into artificial intelligence, startup economics, and the forces shaping our digital future.
        </p>
      </div>
    </div>
  </section>

  <!-- Featured Article -->
  {featuredPost && (
    <section class="py-section">
      <div class="container">
        <a href={`/posts/${featuredPost.slug}`} class="featured-article" style="text-decoration: none; display: grid;">
          {featuredPost.data.heroImage && (
            <div class="article-card-image">
              <img src={featuredPost.data.heroImage} alt={featuredPost.data.title} loading="eager" />
            </div>
          )}
          
          <div class="article-card-content">
            <span class="badge" style="margin-bottom: 1rem;">
              Featured
            </span>
            
            <h2 class="article-card-title" style="font-size: 1.75rem; margin-bottom: 1rem;">
              {featuredPost.data.title}
            </h2>
            
            <p class="article-card-description" style="-webkit-line-clamp: 4;">
              {featuredPost.data.description}
            </p>
            
            <div style="margin-top: auto; display: flex; align-items: center; gap: 1rem;">
              <time style="font-size: 0.875rem; color: var(--text-tertiary);">
                {featuredPost.data.pubDate.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </time>
              <span style="color: var(--text-muted);">·</span>
              <span style="font-size: 0.875rem; color: var(--text-tertiary);">
                {featuredPost.data.reading_time} min read
              </span>
            </div>
            
            <div class="article-card-read">
              Read Full Article →
            </div>
          </div>
        </a>
      </div>
    </section>
  )}

  <!-- More Articles -->
  {recentPosts.length > 0 && (
    <section class="py-section" style="background: var(--bg-secondary);">
      <div class="container">
        <h2 style="margin: 0 0 2.5rem 0; font-size: 1.5rem;">
          More Articles
        </h2>

        <div class="grid-2">
          {recentPosts.map((post) => (
            <a href={`/posts/${post.slug}`} class="article-card" style="text-decoration: none;">
              {post.data.heroImage && (
                <div class="article-card-image">
                  <img src={post.data.heroImage} alt={post.data.title} loading="lazy" />
                </div>
              )}
              
              <div class="article-card-content">
                <div class="article-card-meta">
                  <span class="badge">
                    {post.data.topic}
                  </span>
                  <span style="color: var(--text-tertiary); font-size: 0.875rem;">
                    {post.data.reading_time} min
                  </span>
                </div>
                
                <h3 class="article-card-title">
                  {post.data.title}
                </h3>
                
                <p class="article-card-description">
                  {post.data.description}
                </p>
                
                <div style="margin-top: auto;">
                  <time style="font-size: 0.85rem; color: var(--text-tertiary);">
                    {post.data.pubDate.toLocaleDateString('en-US', {
                      year: 'numeric',
                      month: 'short',
                      day: 'numeric',
                    })}
                  </time>
                  <div class="article-card-read">
                    Read Article →
                  </div>
                </div>
              </div>
            </a>
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- AdSense Ready Slot -->
  <section class="py-section">
    <div class="container">
      <div class="ad-slot ad-slot-horizontal">
        Advertisement
      </div>
    </div>
  </section>
</Base>
